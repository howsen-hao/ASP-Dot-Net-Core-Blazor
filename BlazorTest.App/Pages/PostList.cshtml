@using BlazorTest.App.Services
@page "/postlist"
@inject HttpClient Http
<h1>Post List</h1>

<p>This component demonstrates fetching data from the API.</p>
@if (Posts == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <table class='table'>
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Body</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var post in Posts)
            {
                <tr>
                    <td>@post.Id</td>
                    <td>@post.Title</td>
                    <td>@post.Body</td>
                </tr>
            }
        </tbody>
    </table>
}

@functions {
    private Post[] Posts { get; set; }

    protected override async Task OnInitAsync()
    {
        await RefreshPostList();
    }

    private async Task RefreshPostList()
    {
        string requestUrl = "https://jsonplaceholder.typicode.com/posts";
        Posts = await Http.GetJsonAsync<Post[]>(requestUrl);
        StateHasChanged();
    }
}
